import{I as e,J as t,R as n,r as a,al as o,U as r,P as i,Q as s,Y as c,Z as l,am as d}from"./index-k2JO1M9C.js";import{C as p}from"./index-B3G2HN7z.js";import{I as h}from"./index-EzmHzhvQ.js";import{I as y}from"./index-C9NxgC6G.js";const m={PREFIX:`${e}-collapse`};class u extends t{constructor(e){super(Object.assign({},e))}initActiveKey(){const{defaultActiveKey:e,activeKey:t,accordion:n}=this.getProps();let a=t||e;return n&&(a=Array.isArray(a)?a[0]:a),a&&a.length?(a=Array.isArray(a)?a:[a],a):[]}handleChange(e,t){const{activeKey:n,accordion:a}=this.getProps(),{activeSet:o}=this.getStates();let r=new Set(o);r.has(e)?r.delete(e):a?r=new Set([e]):r.add(e),this._adapter.handleChange([...r.values()],t),void 0===n&&this._adapter.addActiveKey(r)}}const g=n.createContext({});class f extends a.PureComponent{constructor(){super(...arguments),this.headerExpandIconTriggerRef=n.createRef(),this.ariaID="",this.handleClick=(e,t)=>{var n;(this.context.clickHeaderToExpand||(null===(n=this.headerExpandIconTriggerRef.current)||void 0===n?void 0:n.contains(t.target)))&&this.context.onClick(e,t)}}componentDidMount(){this.ariaID=o({})}renderHeader(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{showArrow:a,header:o,extra:i}=this.props;let{expandIcon:s,collapseIcon:c}=this.context;const{expandIconPosition:l}=this.context;void 0===s&&(s=n.createElement(h,null)),void 0===c&&(c=n.createElement(y,null));const d=n.createElement("span",{ref:this.headerExpandIconTriggerRef,"aria-hidden":"true",className:r([`${m.PREFIX}-header-icon`,{[`${m.PREFIX}-header-iconDisabled`]:!t}])},t&&e?c:s),p="left"===l;return"string"==typeof o?n.createElement(n.Fragment,null,a&&(p?d:null),n.createElement("span",null,o),n.createElement("span",{className:`${m.PREFIX}-header-right`},n.createElement("span",null,i),a&&(p?null:d))):n.createElement(n.Fragment,null,a&&(p?d:null),o,a&&(p?null:d))}render(){const e=this.props,{className:t,children:a,itemKey:o,reCalcKey:i,header:s,extra:c,showArrow:l,disabled:d}=e,h=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n}(e,["className","children","itemKey","reCalcKey","header","extra","showArrow","disabled"]),{keepDOM:y,expandIconPosition:u,activeSet:g,motion:f,lazyRender:v}=this.context,x=g.has(o),b=r(t,{[`${m.PREFIX}-item`]:!0}),I=r({[`${m.PREFIX}-header`]:!0,[`${m.PREFIX}-header-disabled`]:d,[`${m.PREFIX}-header-iconLeft`]:"left"===u}),E=r({[`${m.PREFIX}-content`]:!0});return n.createElement("div",Object.assign({className:b},h),n.createElement("div",{role:"button",tabIndex:0,className:I,"aria-disabled":d,"aria-expanded":x?"true":"false","aria-owns":this.ariaID,onClick:e=>!d&&this.handleClick(o,e)},this.renderHeader(x,void 0!==a&&!d)),a&&n.createElement(p,{lazyRender:v,isOpen:x,keepDOM:y,motion:f,onMotionEnd:this.props.onMotionEnd,reCalcKey:i},n.createElement("div",{className:E,"aria-hidden":!x,id:this.ariaID},n.createElement("div",{className:`${m.PREFIX}-content-wrapper`},a))))}}f.contextType=g,f.propTypes={itemKey:i.string,extra:i.node,header:i.oneOfType([i.string,i.node]),className:i.string,reCalcKey:i.oneOfType([i.string,i.number]),showArrow:i.bool,disabled:i.bool},f.defaultProps={showArrow:!0,disabled:!1};class v extends s{constructor(e){super(e),this.onChange=(e,t)=>{this.foundation.handleChange(e,t)},this.foundation=new u(this.adapter);const t=this.foundation.initActiveKey();this.state={activeSet:new Set(t)},this.onChange=this.onChange.bind(this)}get adapter(){return Object.assign(Object.assign({},super.adapter),{handleChange:(e,t)=>this.props.onChange(e,t),addActiveKey:e=>this.setState({activeSet:e})})}static getDerivedStateFromProps(e,t){if(e.activeKey){const n=Array.isArray(e.activeKey)?e.activeKey:[e.activeKey],a=new Set(n);return c(a,t.activeSet)?t:Object.assign(Object.assign({},t),{activeSet:a})}return t}componentWillUnmount(){this.foundation.destroy()}render(){const e=this.props,{defaultActiveKey:t,lazyRender:a,accordion:o,style:i,motion:s,className:c,keepDOM:l,expandIconPosition:d,expandIcon:p,collapseIcon:h,children:y,clickHeaderToExpand:u}=e;!function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}}(e,["defaultActiveKey","lazyRender","accordion","style","motion","className","keepDOM","expandIconPosition","expandIcon","collapseIcon","children","clickHeaderToExpand"]);const f=r(m.PREFIX,c),{activeSet:v}=this.state;return n.createElement("div",Object.assign({className:f,style:i},this.getDataAttr(this.props)),n.createElement(g.Provider,{value:{activeSet:v,expandIcon:p,collapseIcon:h,clickHeaderToExpand:u,keepDOM:l,expandIconPosition:d,onClick:this.onChange,motion:s,lazyRender:a}},y))}}v.Panel=f,v.propTypes={activeKey:i.oneOfType([i.string,i.array]),defaultActiveKey:i.oneOfType([i.string,i.array]),accordion:i.bool,clickHeaderToExpand:i.bool,onChange:i.func,expandIcon:i.node,collapseIcon:i.node,style:i.object,className:i.string,keepDOM:i.bool,motion:i.oneOfType([i.bool,i.func,i.object]),expandIconPosition:i.oneOf(["left","right"]),lazyRender:i.bool},v.__SemiComponentName__="Collapse",v.defaultProps=l(v.__SemiComponentName__,{defaultActiveKey:"",clickHeaderToExpand:!0,onChange:d,expandIconPosition:"right",lazyRender:!1});export{v as C};
