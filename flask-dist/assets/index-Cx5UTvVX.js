import{r as e,R as t,P as s}from"./index-B93kzz_1.js";import{c as n,B as o,i as r,k as a,m as i,p as l,_ as c,t as d}from"./AppContent-DNe_3nC0.js";import{d as p,e as m,f as u,h,g,j as f,k as y,l as b,m as v,n as E,o as w,I,a as T,p as x}from"./index-sw4Tt9-H.js";const N=n((function(t){return e.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},t),e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.08 7.6a1.5 1.5 0 0 1 2.12 0l5.66 5.65 5.66-5.65a1.5 1.5 0 1 1 2.12 2.12l-6.72 6.72a1.5 1.5 0 0 1-2.12 0L4.08 9.72a1.5 1.5 0 0 1 0-2.12Z",fill:"currentColor"}))}),"chevron_down");const C=n((function(t){return e.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},t),e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.44 19.8a1.5 1.5 0 0 1 0-2.13l5.66-5.65-5.66-5.66a1.5 1.5 0 1 1 2.12-2.12l6.72 6.72a1.5 1.5 0 0 1 0 2.12L9.56 19.8a1.5 1.5 0 0 1-2.12 0Z",fill:"currentColor"}))}),"chevron_right"),O={PREFIX:`${o}-dropdown`},k={POSITION_SET:p.POSITION_SET,TRIGGER_SET:["hover","focus","click","custom","contextMenu"],DEFAULT_LEAVE_DELAY:100,ITEM_TYPE:["primary","secondary","tertiary","warning","danger"]},P=4,j=2;class _ extends r{handleVisibleChange(e){this._adapter.setPopVisible(e),this._adapter.notifyVisibleChange(e);const{trigger:t}=this.getProps();if(e&&"click"===t){const e=this._adapter.getPopupId();this.setFocusToFirstMenuItem(e)}}getMenuItemNodes(e){const t=document.getElementById(e);return t?Array.from(t.getElementsByTagName("li")).filter((e=>"false"===e.ariaDisabled)):null}setFocusToFirstMenuItem(e){const t=this.getMenuItemNodes(e);t&&m(t)}setFocusToLastMenuItem(e){const t=this.getMenuItemNodes(e);t&&u(t)}handleKeyDown(e){var t,s;const n=null===(s=null===(t=e.target)||void 0===t?void 0:t.attributes["data-popupid"])||void 0===s?void 0:s.value,{visible:o}=this._adapter.getStates();switch(e.key){case" ":case"Enter":e.target.click();break;case"ArrowDown":this.setFocusToFirstMenuItem(n),o&&h(e);break;case"ArrowUp":this.setFocusToLastMenuItem(n),o&&h(e)}}}class D extends r{constructor(){super(...arguments),this.menuItemNodes=null,this.firstChars=[]}handleEscape(e){if("custom"===this._adapter.getContext("trigger")){(e&&g(document.querySelectorAll("[data-popupid]"),e.id)).focus()}}setFocusByFirstCharacter(e,t){const s=f(this.menuItemNodes,e,this.firstChars,t);s>=0&&y(this.menuItemNodes,this.menuItemNodes[s])}onMenuKeydown(e){const t=b(e.target,"tooltip");this.menuItemNodes||(this.menuItemNodes=[...e.target.parentNode.getElementsByTagName("li")].filter((e=>"true"!==e.ariaDisabled))),0===this.firstChars.length&&this.menuItemNodes.forEach((e=>{var t;this.firstChars.push(null===(t=e.textContent.trim()[0])||void 0===t?void 0:t.toLowerCase())}));const s=this.menuItemNodes.find((e=>0===e.tabIndex));switch(e.key){case" ":case"Enter":e.target.click();break;case"Escape":this.handleEscape(t);break;case"ArrowUp":w(this.menuItemNodes,s),h(e);break;case"ArrowDown":E(this.menuItemNodes,s),h(e);break;default:v(e.key)&&this.setFocusByFirstCharacter(s,e.key)}}}const M=t.createContext({level:0});const F=O.PREFIX;class R extends a{constructor(e){super(e),this.foundation=new D(this.adapter)}get adapter(){return Object.assign({},super.adapter)}render(){const e=this.props,{children:s,className:n,style:o}=e,r=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(s[n[o]]=e[n[o]])}return s}(e,["children","className","style"]);return t.createElement("ul",Object.assign({role:"menu","aria-orientation":"vertical"},r,{className:i(`${F}-menu`,n),style:o,onKeyDown:e=>this.foundation.onMenuKeydown(e)}),s)}}R.propTypes={children:s.node,className:s.string,style:s.object},R.contextType=M;const V=O.PREFIX;class A extends a{render(){const{children:e,disabled:s,className:n,forwardRef:o,style:r,type:a,active:l,icon:c,onKeyDown:d,showTick:p,hover:m}=this.props,{showTick:u}=this.context,h=null!=u?u:p,g=i(n,{[`${V}-item`]:!0,[`${V}-item-disabled`]:s,[`${V}-item-hover`]:m,[`${V}-item-withTick`]:h,[`${V}-item-${a}`]:a,[`${V}-item-active`]:l}),f={};s||["onClick","onMouseEnter","onMouseLeave","onContextMenu"].forEach((e=>{1!==this.context.level&&"onClick"===e?f.onMouseDown=t=>{var s,n;0===t.button&&(null===(n=(s=this.props)[e])||void 0===n||n.call(s,t))}:f[e]=this.props[e]}));let y=null;switch(!0){case h&&l:y=t.createElement(I,null);break;case h&&!l:y=t.createElement(I,{style:{color:"transparent"}});break;default:y=null}let b=null;return c&&(b=t.createElement("div",{className:`${V}-item-icon`},c)),t.createElement("li",Object.assign({role:"menuitem",tabIndex:-1,"aria-disabled":s},f,{onKeyDown:d,ref:e=>o(e),className:g,style:r},this.getDataAttr(this.props)),y,b,e)}}A.propTypes={children:s.oneOfType([s.string,s.node]),name:s.string,disabled:s.bool,selected:s.bool,onClick:s.func,onMouseEnter:s.func,onMouseLeave:s.func,onContextMenu:s.func,className:s.string,style:s.object,forwardRef:s.func,type:s.oneOf(k.ITEM_TYPE),active:s.bool,icon:s.node},A.contextType=M,A.defaultProps={disabled:!1,divided:!1,selected:!1,onMouseEnter:l,onMouseLeave:l,forwardRef:l},A.elementType="Dropdown.Item";const L=O.PREFIX,S=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{style:s,className:n}=e;return t.createElement("div",{className:i(`${L}-divider`,n),style:s})};S.propTypes={style:s.object,className:s.string};const $=O.PREFIX;class K extends e.PureComponent{render(){const{className:e,style:s,children:n}=this.props,{showTick:o}=this.context,r=i({[`${$}-title`]:!0,[`${$}-title-withTick`]:o},e);return t.createElement("div",{className:r,style:s},n)}}K.propTypes={children:s.node,className:s.string,style:s.object},K.contextType=M;var B=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(s[n[o]]=e[n[o]])}return s};const X=k.POSITION_SET,z=k.TRIGGER_SET;class U extends a{constructor(e){super(e),this.handleVisibleChange=e=>this.foundation.handleVisibleChange(e),this.state={popVisible:e.visible},this.foundation=new _(this.adapter),this.tooltipRef=t.createRef()}get adapter(){return Object.assign(Object.assign({},super.adapter),{setPopVisible:e=>this.setState({popVisible:e}),notifyVisibleChange:e=>{var t,s;return null===(s=(t=this.props).onVisibleChange)||void 0===s?void 0:s.call(t,e)},getPopupId:()=>this.tooltipRef.current.getPopupId()})}renderContent(){const{render:e,menu:s,contentClassName:n,style:o,showTick:r,prefixCls:a,trigger:l}=this.props,c=i(a,n),{level:d=0}=this.context,p={showTick:r,level:d+1,trigger:l};let m=null;return t.isValidElement(e)?m=e:Array.isArray(s)&&(m=this.renderMenu()),t.createElement(M.Provider,{value:p},t.createElement("div",{className:c,style:o},t.createElement("div",{className:`${a}-content`,"x-semi-prop":"render"},m)))}renderMenu(){const{menu:e}=this.props,s=e.map(((e,s)=>{switch(e.node){case"title":{const{name:n,node:o}=e,r=B(e,["name","node"]);return t.createElement(U.Title,Object.assign({},r,{key:o+n+s}),n)}case"item":{const{node:n,name:o}=e,r=B(e,["node","name"]);return t.createElement(U.Item,Object.assign({},r,{key:n+o+s}),o)}case"divider":return t.createElement(U.Divider,{key:e.node+s});default:return null}}));return t.createElement(U.Menu,null,s)}renderPopCard(){const{render:e,contentClassName:s,style:n,showTick:o,prefixCls:r}=this.props,a=i(r,s),{level:l=0}=this.context,c={showTick:o,level:l+1};return t.createElement(M.Provider,{value:c},t.createElement("div",{className:a,style:n},t.createElement("div",{className:`${r}-content`},e)))}render(){const e=this.props,{children:s,position:n,trigger:o,onVisibleChange:r,zIndex:a,className:l,motion:d,margin:p,style:m,prefixCls:u}=e,h=B(e,["children","position","trigger","onVisibleChange","zIndex","className","motion","margin","style","prefixCls"]);let{spacing:g}=this.props;const{level:f}=this.context,{popVisible:y}=this.state,b=this.renderContent();return f>0?g="number"==typeof g?g:j:null==g&&(g=P),t.createElement(T,Object.assign({zIndex:a,motion:d,margin:p,content:b,className:l,prefixCls:u,spacing:g,position:n,trigger:o,onVisibleChange:this.handleVisibleChange,showArrow:!1,returnFocusOnClose:!0,ref:this.tooltipRef},h),t.isValidElement(s)?t.cloneElement(s,{className:i(c(s,"props.className"),{[`${u}-showing`]:y}),"aria-haspopup":!0,"aria-expanded":y,onKeyDown:e=>{this.foundation.handleKeyDown(e);const t=c(s,"props.onKeyDown");t&&t(e)}}):s)}}U.Menu=R,U.Item=A,U.Divider=S,U.Title=K,U.contextType=M,U.propTypes={children:s.node,contentClassName:s.oneOfType([s.string,s.array]),className:s.string,getPopupContainer:s.func,margin:s.oneOfType([s.number,s.object]),mouseEnterDelay:s.number,mouseLeaveDelay:s.number,menu:s.array,motion:s.oneOfType([s.bool,s.func,s.object]),onVisibleChange:s.func,prefixCls:s.string,position:s.oneOf(X),rePosKey:s.oneOfType([s.string,s.number]),render:s.node,spacing:s.oneOfType([s.number,s.object]),showTick:s.bool,style:s.object,trigger:s.oneOf(z),visible:s.bool,zIndex:s.number},U.__SemiComponentName__="Dropdown",U.defaultProps=d(U.__SemiComponentName__,{onVisibleChange:l,prefixCls:O.PREFIX,zIndex:x.DEFAULT_Z_INDEX,motion:!0,trigger:"hover",position:"bottom",mouseLeaveDelay:k.DEFAULT_LEAVE_DELAY,showTick:!1,closeOnEsc:!0,onEscKeyDown:l});export{U as D,C as I,N as a};
