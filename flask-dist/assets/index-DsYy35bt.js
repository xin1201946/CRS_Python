import{B as e,R as t,F as s,L as o,ak as i,N as n,P as a,H as l,z as r,D as d,al as p,I as h,Z as c,K as m}from"./index-CiQzaChg.js";import{k as y,P as b}from"./keyCode-BPRnlZ-b.js";const g={PREFIX:`${e}-sidesheet`},u=["top","right","bottom","left"],f=["small","medium","large"],w=448;var C=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};let v=0;const O=g.PREFIX;class k extends t.PureComponent{constructor(){super(...arguments),this.onMaskClick=e=>{e.target===e.currentTarget&&this.close(e)},this.close=e=>{const{onClose:t}=this.props;t&&t(e)}}componentDidMount(){this.sideSheetId="sidesheet-"+v++}componentWillUnmount(){clearTimeout(this.timeoutId)}getMaskElement(){var e;const{mask:o,maskStyle:i,maskClosable:n}=this.props;return o?t.createElement("div",Object.assign({"aria-hidden":!0,key:"mask",className:s(`${O}-mask`,null!==(e=this.props.maskClassName)&&void 0!==e?e:""),style:i,onClick:n?this.onMaskClick:null},this.props.maskExtraProps)):null}renderHeader(){const{title:e,closable:s,headerStyle:i,closeIcon:a}=this.props;let l,r;if(e&&(l=t.createElement("div",{className:`${O}-title`,"x-semi-prop":"title"},this.props.title)),s){const e=a||t.createElement(n,null);r=t.createElement(o,{className:`${O}-close`,key:"close-btn",onClick:this.close,type:"tertiary",icon:e,theme:"borderless",size:"small"})}return t.createElement("div",{className:`${O}-header`,role:"heading","aria-level":1,style:Object.assign({},i)},l,r)}getDialogElement(){var e;const o=C(this.props,[]),i={};o.width&&(i.width=o.width,o.mask||(i.width="100%")),o.height&&(i.height=o.height);const n=this.renderHeader();return t.createElement("div",Object.assign({key:"dialog-element",role:"dialog",tabIndex:-1,className:s(`${O}-inner`,`${O}-inner-wrap`,null!==(e=this.props.dialogClassName)&&void 0!==e?e:"",`${O}-size-${o.size}`),style:Object.assign(Object.assign({},o.style),i)},this.props.wrapperExtraProps),t.createElement("div",{className:`${O}-content`},n,t.createElement("div",{className:`${O}-body`,style:o.bodyStyle,"x-semi-prop":"children"},o.children),o.footer?t.createElement("div",{className:`${O}-footer`,"x-semi-prop":"footer"},o.footer):null))}render(){const e=this.props,{mask:o,className:n,width:a,onClose:l,maskStyle:r,maskClosable:d,maskClassName:p,title:h,closable:c,headerStyle:m,height:y,style:b,size:g,bodyStyle:u,dialogClassName:f,children:w,footer:v,maskExtraProps:k,wrapperExtraProps:N}=e,S=C(e,["mask","className","width","onClose","maskStyle","maskClosable","maskClassName","title","closable","headerStyle","height","style","size","bodyStyle","dialogClassName","children","footer","maskExtraProps","wrapperExtraProps"]),E=s(n,{[`${O}-fixed`]:!o,[`${O}-size-${this.props.size}`]:!o}),P={};!o&&a&&(P.width=a);const j=i(S);return t.createElement("div",Object.assign({className:E,style:P},j),this.getMaskElement(),this.getDialogElement())}}k.propTypes={onClose:a.func,closeIcon:a.node},k.defaultProps={onClose:l};class N extends r{constructor(e){super(Object.assign(Object.assign({},N.defaultAdapter),e)),this.toggleDisplayNone=e=>{this._adapter.toggleDisplayNone(e)}}get defaultAdapter(){return{handleCancel:l,beforeShow:l,afterHide:l}}destroy(){this.afterHide()}handleCancel(e){this._adapter.notifyCancel(e)}beforeShow(){this.getProp("disableScroll")&&this._adapter.disabledBodyScroll(),this._adapter.setOnKeyDownListener()}afterHide(){this.getProp("disableScroll")&&this._adapter.enabledBodyScroll(),this._adapter.removeKeyDownListener()}handleKeyDown(e){const{closeOnEsc:t}=this.getProps();if(t&&e.keyCode===y.ESC)return e.stopPropagation(),void this.handleCancel(e)}onVisibleChange(e){this._adapter.notifyVisibleChange(e)}}const S=g.PREFIX,E=w;class P extends d{constructor(e){super(e),this.handleCancel=e=>{this.foundation.handleCancel(e)},this.handleKeyDown=e=>{this.foundation.handleKeyDown(e)},this.updateState=()=>{this.foundation.toggleDisplayNone(!this.props.visible)},this.state={displayNone:!this.props.visible},this.foundation=new N(this.adapter),this.bodyOverflow="",this.scrollBarWidth=0,this.originBodyWidth="100%"}get adapter(){return Object.assign(Object.assign({},super.adapter),{disabledBodyScroll:()=>{const{getPopupContainer:e}=this.props;this.bodyOverflow=document.body.style.overflow||"",e||"hidden"===this.bodyOverflow||(document.body.style.overflow="hidden",document.body.style.width=`calc(${this.originBodyWidth||"100%"} - ${this.scrollBarWidth}px)`)},enabledBodyScroll:()=>{const{getPopupContainer:e}=this.props;e||"hidden"===this.bodyOverflow||(document.body.style.overflow=this.bodyOverflow,document.body.style.width=this.originBodyWidth)},notifyCancel:e=>{this.props.onCancel&&this.props.onCancel(e)},notifyVisibleChange:e=>{this.props.afterVisibleChange(e)},setOnKeyDownListener:()=>{window&&window.addEventListener("keydown",this.handleKeyDown)},removeKeyDownListener:()=>{window&&window.removeEventListener("keydown",this.handleKeyDown)},toggleDisplayNone:e=>{e!==this.state.displayNone&&this.setState({displayNone:e})}})}static getDerivedStateFromProps(e,t){const s={};return e.visible&&t.displayNone&&(s.displayNone=!1),e.visible||e.motion||t.displayNone||(s.displayNone=!0),s}componentDidMount(){this.scrollBarWidth=p(),this.originBodyWidth=document.body.style.width,this.props.visible&&this.foundation.beforeShow()}componentDidUpdate(e,t,s){!e.visible&&this.props.visible&&this.foundation.beforeShow(),e.visible&&!this.props.visible&&this.foundation.afterHide(),t.displayNone!==this.state.displayNone&&this.foundation.onVisibleChange(!this.state.displayNone)}componentWillUnmount(){this.props.visible&&this.foundation.destroy()}renderContent(){const e=this.props,{placement:o,className:i,children:n,width:a,height:l,motion:r,visible:d,style:p,maskStyle:c,size:m,zIndex:y,getPopupContainer:g,keepDOM:u}=e,f=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s}(e,["placement","className","children","width","height","motion","visible","style","maskStyle","size","zIndex","getPopupContainer","keepDOM"]);let w={zIndex:y};g&&(w={zIndex:y,position:"static"});const{direction:C}=this.context,v="left"===o||"right"===o,O="top"===o||"bottom"===o,N=O?l||E:"100%",P=s(S,i,{[`${S}-${o}`]:o,[`${S}-popup`]:g,[`${S}-horizontal`]:O,[`${S}-rtl`]:"rtl"===C,[`${S}-hidden`]:u&&this.state.displayNone}),j=Object.assign(Object.assign(Object.assign({},v?a?{width:a}:{}:{width:"100%"}),f),{visible:d,motion:!1,size:m,className:P,height:N,onClose:this.handleCancel}),x=this.props.visible||this.props.keepDOM||this.props.motion&&!this.state.displayNone;return t.createElement(h,{motion:this.props.motion,animationState:d?"enter":"leave",startClassName:d?`${S}-animation-mask_show`:`${S}-animation-mask_hide`,onAnimationEnd:this.updateState},(e=>{let{animationClassName:s,animationEventsNeedBind:o}=e;return t.createElement(h,{motion:this.props.motion,animationState:d?"enter":"leave",startClassName:d?`${S}-animation-content_show_${this.props.placement}`:`${S}-animation-content_hide_${this.props.placement}`,onAnimationEnd:this.updateState},(e=>{let{animationClassName:i,animationStyle:a,animationEventsNeedBind:l}=e;return x?t.createElement(b,{getPopupContainer:g,style:w},t.createElement(k,Object.assign({},j,{maskExtraProps:o,wrapperExtraProps:l,dialogClassName:i,maskClassName:s,maskStyle:Object.assign({},c),style:Object.assign(Object.assign({},a),p)}),n)):t.createElement(t.Fragment,null)}))}))}render(){const{zIndex:e,getPopupContainer:t,visible:s}=this.props;return this.renderContent()}}P.contextType=c,P.propTypes={bodyStyle:a.object,headerStyle:a.object,children:a.node,className:a.string,closable:a.bool,disableScroll:a.bool,getPopupContainer:a.func,height:a.oneOfType([a.number,a.string]),mask:a.bool,maskClosable:a.bool,maskStyle:a.object,motion:a.oneOfType([a.bool,a.object,a.func]),onCancel:a.func,placement:a.oneOf(u),size:a.oneOf(f),style:a.object,title:a.node,visible:a.bool,width:a.oneOfType([a.number,a.string]),zIndex:a.number,afterVisibleChange:a.func,closeOnEsc:a.bool,footer:a.node,keepDOM:a.bool,"aria-label":a.string},P.__SemiComponentName__="SideSheet",P.defaultProps=m(P.__SemiComponentName__,{visible:!1,motion:!0,mask:!0,placement:"right",closable:!0,footer:null,zIndex:1e3,maskClosable:!0,size:"small",disableScroll:!0,closeOnEsc:!1,afterVisibleChange:l,keepDOM:!1});export{P as S};
