import{z as t,a3 as e,a9 as o,R as s,D as r,F as n,aa as i,K as a,P as l}from"./index-CiQzaChg.js";import{g as c,s as p}from"./index-CpoOHKow.js";import{h}from"./index-DAldieki.js";class d extends t{constructor(t){super(Object.assign({},t)),this.handleFocusVisible=t=>{const{target:o}=t;try{o.matches(":focus-visible")&&this._adapter.setFocusVisible(!0)}catch(s){e(!0,"Warning: [Semi Avatar] The current browser does not support the focus-visible")}},this.handleBlur=()=>{this._adapter.setFocusVisible(!1)},this.changeScale=()=>{const{gap:t}=this.getProps(),e=this._adapter.getAvatarNode(),o=null==e?void 0:e.firstChild,[s,r]=[(null==e?void 0:e.offsetWidth)||0,(null==o?void 0:o.offsetWidth)||0];if(0!==s&&0!==r&&2*t<s){const e=s-2*t>r?1:(s-2*t)/r;this._adapter.setScale(e)}}}init(){const{children:t}=this.getProps();"string"==typeof t&&this.changeScale()}destroy(){}handleImgLoadError(){const{onError:t}=this.getProps();!1!==(t?t():void 0)&&this._adapter.notifyImgState(!1)}handleEnter(t){this._adapter.notifyEnter(t)}handleLeave(t){this._adapter.notifyLeave(t)}}const m=t=>{let{gradientStart:e,gradientEnd:r}=t;const n=o();return s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"51",height:"52",viewBox:"0 0 51 52",fill:"none"},s.createElement("g",{filter:"url(#filter0_d_6_2)"},s.createElement("path",{d:"M40.4918 46.5592C44.6795 43.176 46.261 34.1333 47.5301 25.6141C49.5854 11.8168 39.6662 1 25.8097 1C11.2857 1 3 11.4279 3 25.3518C3 33.7866 6.29361 43.8947 10.4602 46.5592C12.5868 47.9192 12.5868 47.9051 25.8097 47.9192C38.3651 47.9282 38.5352 48.14 40.4918 46.5592Z",fill:`url(#${n})`})),s.createElement("defs",null,s.createElement("filter",{id:"filter0_d_6_2",x:"0.789215",y:"0.447304",width:"49.2216",height:"51.3549",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.createElement("feOffset",{dy:"1.65809"}),s.createElement("feGaussianBlur",{stdDeviation:"1.10539"}),s.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0"}),s.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_6_2"}),s.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_6_2",result:"shape"})),s.createElement("linearGradient",{id:n,x1:"17.671",y1:"31.7392",x2:"17.671",y2:"47.9333",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:e}),s.createElement("stop",{offset:"1",stopColor:r}))))};const u=p.SIZE,g=p.SHAPE,f=p.COLOR,b=c.PREFIX;class v extends r{constructor(t){super(t),this.handleFocusVisible=t=>{this.foundation.handleFocusVisible(t)},this.handleBlur=t=>{this.foundation.handleBlur()},this.getContent=()=>{const{children:t,onClick:e,imgAttr:o,src:r,srcSet:a,alt:l}=this.props,{isImgExist:c}=this.state;let p=t;const h=e!==i,d=r&&c,m={tabIndex:0,onKeyDown:this.handleKeyDown,onFocus:this.handleFocusVisible,onBlur:this.handleBlur};if(d){const t=h?`clickable Avatar: ${l}`:l,e=Object.assign(Object.assign({src:r,srcSet:a,onError:this.handleError},o),{className:n({[`${b}-no-focus-visible`]:h})}),i=h?Object.assign(Object.assign({},e),m):e;p=s.createElement("img",Object.assign({alt:t},i))}else if("string"==typeof t){const e=null!=l?l:t,o={role:"img","aria-label":h?`clickable Avatar: ${e}`:e,className:n(`${b}-label`,{[`${b}-no-focus-visible`]:h})},r=h?Object.assign(Object.assign({},o),m):o,i={transform:`scale(${this.state.scale})`};p=s.createElement("span",{className:`${b}-content`,style:i},s.createElement("span",Object.assign({},r,{"x-semi-prop":"children"}),t))}return p},this.renderBottomSlot=()=>{var t,e;if(!this.props.bottomSlot)return null;if(this.props.bottomSlot.render)return this.props.bottomSlot.render();const o=null!==(t=this.props.bottomSlot.render)&&void 0!==t?t:()=>{var t;const e={};return this.props.bottomSlot.bgColor&&(e.backgroundColor=this.props.bottomSlot.bgColor),this.props.bottomSlot.textColor&&(e.color=this.props.bottomSlot.textColor),s.createElement("span",{style:e,className:n(`${b}-bottom_slot-shape_${this.props.bottomSlot.shape}`,`${b}-bottom_slot-shape_${this.props.bottomSlot.shape}-${this.props.size}`,null!==(t=this.props.bottomSlot.className)&&void 0!==t?t:"")},this.props.bottomSlot.text)};return s.createElement("div",{className:n([`${b}-bottom_slot`]),style:null!==(e=this.props.bottomSlot.style)&&void 0!==e?e:{}},o())},this.renderTopSlot=()=>{var t,e,o,r;if(!this.props.topSlot)return null;if(this.props.topSlot.render)return this.props.topSlot.render();const i={};return this.props.topSlot.textColor&&(i.color=this.props.topSlot.textColor),s.createElement("div",{style:null!==(t=this.props.topSlot.style)&&void 0!==t?t:{},className:n([`${b}-top_slot-wrapper`,null!==(e=this.props.topSlot.className)&&void 0!==e?e:"",{[`${b}-animated`]:this.props.contentMotion}])},s.createElement("div",{className:n([`${b}-top_slot-bg`,`${b}-top_slot-bg-${this.props.size}`])},s.createElement("div",{className:n([`${b}-top_slot-bg-svg`,`${b}-top_slot-bg-svg-${this.props.size}`])},s.createElement(m,{gradientStart:null!==(o=this.props.topSlot.gradientStart)&&void 0!==o?o:"var(--semi-color-primary)",gradientEnd:null!==(r=this.props.topSlot.gradientEnd)&&void 0!==r?r:"var(--semi-color-primary)"}))),s.createElement("div",{className:n([`${b}-top_slot`])},s.createElement("div",{style:i,className:n([`${b}-top_slot-content`,`${b}-top_slot-content-${this.props.size}`])},this.props.topSlot.text)))},this.state={isImgExist:!0,hoverContent:"",focusVisible:!1,scale:1},this.onEnter=this.onEnter.bind(this),this.onLeave=this.onLeave.bind(this),this.handleError=this.handleError.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.getContent=this.getContent.bind(this),this.avatarRef=s.createRef()}get adapter(){return Object.assign(Object.assign({},super.adapter),{notifyImgState:t=>{this.setState({isImgExist:t})},notifyEnter:t=>{const{hoverMask:e}=this.props,o=e;this.setState({hoverContent:o},(()=>{const{onMouseEnter:e}=this.props;e&&e(t)}))},notifyLeave:t=>{this.setState({hoverContent:""},(()=>{const{onMouseLeave:e}=this.props;e&&e(t)}))},setFocusVisible:t=>{this.setState({focusVisible:t})},setScale:t=>{this.setState({scale:t})},getAvatarNode:()=>{var t;return null===(t=this.avatarRef)||void 0===t?void 0:t.current}})}componentDidMount(){this.foundation=new d(this.adapter),this.foundation.init()}componentDidUpdate(t){if(this.props.src&&this.props.src!==t.src){const t=new Image(0,0);t.src=this.props.src,t.onload=()=>{this.setState({isImgExist:!0})},t.onerror=()=>{this.setState({isImgExist:!1})},t.onabort=()=>{this.setState({isImgExist:!1})}}"string"==typeof this.props.children&&this.props.children!==t.children&&this.foundation.changeScale()}componentWillUnmount(){this.foundation.destroy()}onEnter(t){this.foundation.handleEnter(t)}onLeave(t){this.foundation.handleLeave(t)}handleError(){this.foundation.handleImgLoadError()}handleKeyDown(t){const{onClick:e}=this.props;switch(t.key){case"Enter":e(t),h(t);break;case"Escape":t.target.blur()}}render(){var t;const e=this.props,{shape:o,children:r,size:i,color:a,className:l,hoverMask:c,onClick:h,imgAttr:d,src:m,srcSet:u,style:g,alt:f,gap:v,bottomSlot:E,topSlot:S,border:y,contentMotion:$}=e,x=function(t,e){var o={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(o[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(o[s[r]]=t[s[r]])}return o}(e,["shape","children","size","color","className","hoverMask","onClick","imgAttr","src","srcSet","style","alt","gap","bottomSlot","topSlot","border","contentMotion"]),{isImgExist:C,hoverContent:_,focusVisible:O}=this.state;let j={};p.SIZE.includes(i)||(j={width:i,height:i}),j=Object.assign(Object.assign({},j),g);const N=E||S||y,w={onClick:h,onMouseEnter:this.onEnter,onMouseLeave:this.onLeave},I=m&&C,M=n(b,{[`${b}-${o}`]:o,[`${b}-${i}`]:i,[`${b}-${a}`]:a&&!I,[`${b}-img`]:I,[`${b}-focus`]:O,[`${b}-animated`]:$},l),B=_?s.createElement("div",{className:`${b}-hover`,"x-semi-prop":"hoverContent"},_):null;let k=s.createElement("span",Object.assign({},x,{style:N?{}:j,className:M},N?{}:w,{role:"listitem",ref:this.avatarRef}),this.getContent(),B);if(y){const e={};"object"==typeof y&&(null==y?void 0:y.color)&&(e.borderColor=null==y?void 0:y.color),k=s.createElement("div",{style:Object.assign({position:"relative"},j)},k,s.createElement("span",{style:e,className:n([`${b}-additionalBorder`,`${b}-additionalBorder-${i}`,{[`${b}-${o}`]:o}])}),"object"==typeof this.props.border&&this.props.border.motion&&s.createElement("span",{style:e,className:n([`${b}-additionalBorder`,`${b}-additionalBorder-${i}`,{[`${b}-${o}`]:o,[`${b}-additionalBorder-animated`]:"object"==typeof this.props.border&&(null===(t=this.props.border)||void 0===t?void 0:t.motion)}])}))}return N?s.createElement("span",Object.assign({className:n([`${b}-wrapper`]),style:j},w),k,S&&["extra-small","small","default","medium","large","extra-large"].includes(i)&&"circle"===o&&this.renderTopSlot(),E&&["extra-small","small","default","medium","large","extra-large"].includes(i)&&this.renderBottomSlot()):k}}v.__SemiComponentName__="Avatar",v.defaultProps=a(v.__SemiComponentName__,{size:"medium",color:"grey",shape:"circle",gap:3,onClick:i,onMouseEnter:i,onMouseLeave:i}),v.propTypes={children:l.node,color:l.oneOf(f),shape:l.oneOf(g),size:l.oneOf(u),hoverMask:l.node,className:l.string,style:l.object,gap:l.number,imgAttr:l.object,src:l.string,srcSet:l.string,alt:l.string,onError:l.func,onClick:l.func,onMouseEnter:l.func,onMouseLeave:l.func,bottomSlot:l.shape({render:l.func,shape:l.oneOf(["circle","square"]),text:l.node,bgColor:l.string,textColor:l.string,className:l.string,style:l.object}),topSlot:l.shape({render:l.func,gradientStart:l.string,gradientEnd:l.string,text:l.node,textColor:l.string,className:l.string,style:l.object}),border:l.oneOfType([l.shape({color:l.string,motion:l.bool}),l.bool]),contentMotion:l.bool},v.elementType="Avatar";export{v as A};
