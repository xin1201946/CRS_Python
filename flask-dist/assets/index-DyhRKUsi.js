import{_ as e}from"./index-fs5Z28YX.js";import{a as t,E as n}from"./pick-C2YSPQei.js";import{v as s,r as a,K as o,N as r,Y as i,ap as l,bf as d,R as h,U as u,W as p,X as c,P as f}from"./index-BEnZJKm2.js";import{_ as g}from"./index-DXmumF3A.js";import{I as y}from"./IconClear-ldv0jllP.js";const m=s((function(e){return a.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.7 3.7a1 1 0 0 0-1.4-1.4L17.3 5.26A11.59 11.59 0 0 0 12 4C5 4 1 10 1 12c0 1.18 1.38 3.73 3.94 5.64L2.3 20.3a1 1 0 1 0 1.42 1.42l18-18ZM7.84 14.77l1.46-1.47a3 3 0 0 1 4-4l1.47-1.46a5 5 0 0 0-6.93 6.93Z",fill:"currentColor"}),a.createElement("path",{d:"M12 20c-1.22 0-2.35-.18-3.38-.5l2.57-2.57a5 5 0 0 0 5.75-5.75l3.56-3.56C22.13 9.27 23 11.07 23 12c0 2-4 8-11 8Z",fill:"currentColor"}))}),"eye_closed_solid");const b=s((function(e){return a.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 4C5 4 1 10 1 12s4 8 11 8 11-6 11-8-4-8-11-8Zm5 8a5 5 0 1 1-10 0 5 5 0 0 1 10 0Zm-5 3a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",fill:"currentColor"}))}),"eye_opened"),w={PREFIX:`${o}-input`},C={SIZE:["small","large","default"],DEFAULT_SIZE:"default",STATUS:["default","error","warning","success"],CLEARBTN_CLICKED_EVENT_FLAG:"__fromClearBtn",MODE:["password"]},v={};function _(e){const{value:n,maxLength:s,getValueLength:a}=e;if(t(a)){let e=0,t=n.length;for(;e<t;){const o=e+Math.floor((t-e)/2);a(n.slice(0,o+1))>s?t=o:e=o+1}return n.slice(0,e)}return n.slice(0,s)}class x extends r{static get inputDefaultAdapter(){return{notifyChange:i,setValue:i}}constructor(e){super(Object.assign(Object.assign({},x.inputDefaultAdapter),e))}destroy(){this._timer&&(clearTimeout(this._timer),this._timer=null)}setDisable(){}setValue(e){this._adapter.setValue(e)}handleChange(e,n){const{maxLength:s,minLength:a,getValueLength:o}=this._adapter.getProps();let r=e;s&&t(o)&&(r=this.handleVisibleMaxLength(e)),a&&t(o)&&this.handleVisibleMinLength(r),this._isControlledComponent()||this._adapter.setValue(r),this._adapter.notifyChange(r,n)}handleVisibleMinLength(e){const{minLength:n,getValueLength:s}=this._adapter.getProps(),{minLength:a}=this._adapter.getStates();if(l(n)&&n>=0&&t(s)&&g(e)){const t=s(e);if(t<n){const s=e.length+(n-t);s!==a&&this._adapter.setMinLength(s)}else a!==n&&this._adapter.setMinLength(n)}}handleVisibleMaxLength(e){const{maxLength:n,getValueLength:s}=this._adapter.getProps();if(l(n)&&n>=0&&t(s)&&g(e)){if(s(e)>n){return this.handleTruncateValue(e,n)}return e}return e}handleTruncateValue(e,t){const{getValueLength:n}=this._adapter.getProps();return _({value:e,maxLength:t,getValueLength:n})}handleClear(e){let t=e;this._isControlledComponent("value")?this._adapter.setState({isFocus:!1}):this._adapter.setState({value:"",isFocus:!1}),t&&"object"==typeof t||(t={}),d(t,C.CLEARBTN_CLICKED_EVENT_FLAG,!0),this._adapter.notifyChange("",t),this._adapter.notifyClear(t),t&&this.stopPropagation(t)}handleClick(e){const{disabled:t}=this._adapter.getProps(),{isFocus:n}=this._adapter.getStates();t||n||this._adapter.isEventTarget(e)&&(this._adapter.focusInput(),this._adapter.toggleFocusing(!0))}handleModeChange(e){"password"===e?this._adapter.setEyeClosed(!0):this._adapter.setEyeClosed(!1)}handleClickEye(e){const t=this._adapter.getState("eyeClosed");this._adapter.focusInput(),this._adapter.toggleFocusing(!0),this._adapter.setEyeClosed(!t)}handleInputType(e){const t=this._adapter.getProp("mode"),n=this._adapter.getState("eyeClosed");return"password"===t?n?"password":"text":e}handleMouseDown(e){e.preventDefault()}handleMouseUp(e){e.preventDefault()}handleBlur(e){const{value:t}=this.getStates();this._adapter.toggleFocusing(!1),this._adapter.notifyBlur(t,e)}handleFocus(e){const{value:t}=this.getStates();this._adapter.toggleFocusing(!0),this._adapter.notifyFocus(t,e)}handleInput(e){this._adapter.notifyInput(e)}handleKeyDown(e){this._adapter.notifyKeyDown(e)}handleKeyUp(e){this._adapter.notifyKeyUp(e)}handleKeyPress(e){this._adapter.notifyKeyPress(e),e.key===n&&this._adapter.notifyEnterPress(e)}isAllowClear(){const{value:e,isFocus:t,isHovering:n}=this._adapter.getStates(),{showClear:s,disabled:a,showClearIgnoreDisabled:o}=this._adapter.getProps();return e&&s&&(!a||o)&&(t||n)}handleClickPrefixOrSuffix(e){const{disabled:t}=this._adapter.getProps(),{isFocus:n}=this._adapter.getStates();t||n||(this._adapter.focusInput(),this._adapter.toggleFocusing(!0))}handlePreventMouseDown(e){e&&t(e.preventDefault)&&e.preventDefault()}handleModeEnterPress(e){["Enter"," "].includes(null==e?void 0:e.key)&&(this.handlePreventMouseDown(e),this.handleClickEye(e))}}const E=w.PREFIX,S=C.SIZE,L=C.STATUS,P=C.MODE;class M extends u{constructor(e){super(e),this.handleClear=e=>{this.foundation.handleClear(e)},this.handleClick=e=>{this.foundation.handleClick(e)},this.handleMouseOver=e=>{this.setState({isHovering:!0})},this.handleMouseLeave=e=>{this.setState({isHovering:!1})},this.handleModeChange=e=>{this.foundation.handleModeChange(e)},this.handleClickEye=e=>{this.foundation.handleClickEye(e)},this.handleMouseDown=e=>{this.foundation.handleMouseDown(e)},this.handleMouseUp=e=>{this.foundation.handleMouseUp(e)},this.handleModeEnterPress=e=>{this.foundation.handleModeEnterPress(e)},this.handleClickPrefixOrSuffix=e=>{this.foundation.handleClickPrefixOrSuffix(e)},this.handlePreventMouseDown=e=>{this.foundation.handlePreventMouseDown(e)};const t="value"in e?e.value:e.defaultValue;this.state={value:t,cachedValue:e.value,disabled:!1,props:{},isFocus:!1,isHovering:!1,eyeClosed:"password"===e.mode,minLength:e.minLength},this.inputRef=h.createRef(),this.prefixRef=h.createRef(),this.suffixRef=h.createRef(),this.foundation=new x(this.adapter)}get adapter(){return Object.assign(Object.assign({},super.adapter),{setValue:e=>this.setState({value:e}),setEyeClosed:e=>this.setState({eyeClosed:e}),toggleFocusing:e=>{this.setState({isFocus:e})},focusInput:()=>{const{preventScroll:e}=this.props,t=this.inputRef&&this.inputRef.current;t&&t.focus({preventScroll:e})},toggleHovering:e=>this.setState({isHovering:e}),getIfFocusing:()=>this.state.isFocus,notifyChange:(e,t)=>this.props.onChange(e,t),notifyBlur:(e,t)=>this.props.onBlur(t),notifyFocus:(e,t)=>this.props.onFocus(t),notifyInput:e=>this.props.onInput(e),notifyKeyPress:e=>this.props.onKeyPress(e),notifyKeyDown:e=>this.props.onKeyDown(e),notifyKeyUp:e=>this.props.onKeyUp(e),notifyEnterPress:e=>this.props.onEnterPress(e),notifyClear:e=>this.props.onClear(e),setMinLength:e=>this.setState({minLength:e}),isEventTarget:e=>e&&e.target===e.currentTarget})}static getDerivedStateFromProps(e,t){const n={};return e.value!==t.cachedValue&&(n.value=e.value,n.cachedValue=e.value),n}componentDidUpdate(e){const{mode:t}=this.props;e.mode!==t&&this.handleModeChange(t)}componentDidMount(){const{disabled:e,autoFocus:t,preventScroll:n}=this.props;e||!t&&!this.props.autofocus||this.inputRef.current.focus({preventScroll:n})}renderPrepend(){const{addonBefore:e}=this.props;if(e){const t=p({[`${E}-prepend`]:!0,[`${E}-prepend-text`]:e&&g(e),[`${E}-prepend-icon`]:c(e)});return h.createElement("div",{className:t,"x-semi-prop":"addonBefore"},e)}return null}renderAppend(){const{addonAfter:e}=this.props;if(e){const t=p({[`${E}-append`]:!0,[`${E}-append-text`]:e&&g(e),[`${E}-append-icon`]:c(e)});return h.createElement("div",{className:t,"x-semi-prop":"addonAfter"},e)}return null}renderClearBtn(){const e=p(`${E}-clearbtn`),{clearIcon:t}=this.props;return this.foundation.isAllowClear()?h.createElement("div",{className:e,onMouseDown:this.handleClear},t||h.createElement(y,null)):null}renderModeBtn(){const{eyeClosed:e}=this.state,{mode:t,disabled:n}=this.props,s=p(`${E}-modebtn`),a=e?h.createElement(m,null):h.createElement(b,null),o=e?"Show password":"Hidden password";return"password"===t&&!n?h.createElement("div",{role:"button",tabIndex:0,"aria-label":o,className:s,onClick:this.handleClickEye,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onKeyPress:this.handleModeEnterPress},a):null}renderPrefix(){const{prefix:e,insetLabel:t,insetLabelId:n}=this.props,s=e||t;if(!s)return null;const a=p({[`${E}-prefix`]:!0,[`${E}-inset-label`]:t,[`${E}-prefix-text`]:s&&g(s),[`${E}-prefix-icon`]:c(s)});return h.createElement("div",{className:a,onMouseDown:this.handlePreventMouseDown,onClick:this.handleClickPrefixOrSuffix,id:n,"x-semi-prop":"prefix,insetLabel"},s)}renderSuffix(e){const{suffix:t,hideSuffix:n}=this.props;if(!t)return null;const s=p({[`${E}-suffix`]:!0,[`${E}-suffix-text`]:t&&g(t),[`${E}-suffix-icon`]:c(t),[`${E}-suffix-hidden`]:e&&Boolean(n)});return h.createElement("div",{className:s,onMouseDown:this.handlePreventMouseDown,onClick:this.handleClickPrefixOrSuffix,"x-semi-prop":"suffix"},t)}getInputRef(){const{forwardRef:t}=this.props;if(!e(t)){if("function"==typeof t)return e=>{t(e),this.inputRef={current:e}};if("[object Object]"===Object.prototype.toString.call(t))return this.inputRef=t,t}return this.inputRef}render(){const e=this.props,{addonAfter:n,addonBefore:s,autoFocus:a,clearIcon:o,className:r,disabled:i,defaultValue:l,placeholder:d,prefix:u,mode:f,insetLabel:g,insetLabelId:y,validateStatus:m,type:b,readonly:w,size:C,suffix:v,style:_,showClear:x,onEnterPress:S,onClear:L,hideSuffix:P,inputStyle:M,forwardRef:$,maxLength:D,getValueLength:I,preventScroll:F,borderless:O,showClearIgnoreDisabled:V,onlyBorder:K}=e,R=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(n[s[a]]=e[s[a]])}return n}(e,["addonAfter","addonBefore","autoFocus","clearIcon","className","disabled","defaultValue","placeholder","prefix","mode","insetLabel","insetLabelId","validateStatus","type","readonly","size","suffix","style","showClear","onEnterPress","onClear","hideSuffix","inputStyle","forwardRef","maxLength","getValueLength","preventScroll","borderless","showClearIgnoreDisabled","onlyBorder"]),{value:j,isFocus:B,minLength:A}=this.state,k=this.foundation.isAllowClear(),T=c(v),U=this.getInputRef(),N=`${E}-wrapper`,Z=p(N,r,{[`${E}-wrapper__with-prefix`]:u||g,[`${E}-wrapper__with-suffix`]:v,[`${E}-wrapper__with-suffix-hidden`]:k&&Boolean(P),[`${E}-wrapper__with-suffix-icon`]:T,[`${E}-wrapper__with-append`]:s,[`${E}-wrapper__with-prepend`]:n,[`${E}-wrapper__with-append-only`]:s&&!n,[`${E}-wrapper__with-prepend-only`]:!s&&n,[`${N}-readonly`]:w,[`${N}-disabled`]:i,[`${N}-warning`]:"warning"===m,[`${N}-error`]:"error"===m,[`${N}-focus`]:B,[`${N}-clearable`]:x,[`${N}-modebtn`]:"password"===f,[`${N}-hidden`]:"hidden"===b,[`${N}-${C}`]:C,[`${E}-borderless`]:O,[`${E}-only_border`]:null!=K}),H=p(E,{[`${E}-${C}`]:C,[`${E}-disabled`]:i,[`${E}-sibling-clearbtn`]:this.foundation.isAllowClear(),[`${E}-sibling-modebtn`]:"password"===f}),z=null==j?"":j,X=Object.assign(Object.assign({},R),{style:M,className:H,disabled:i,readOnly:w,type:this.foundation.handleInputType(b),placeholder:d,onInput:e=>this.foundation.handleInput(e),onChange:e=>this.foundation.handleChange(e.target.value,e),onFocus:e=>this.foundation.handleFocus(e),onBlur:e=>this.foundation.handleBlur(e),onKeyUp:e=>this.foundation.handleKeyUp(e),onKeyDown:e=>this.foundation.handleKeyDown(e),onKeyPress:e=>this.foundation.handleKeyPress(e),value:z});t(I)||(X.maxLength=D),A&&(X.minLength=A),"error"===m&&(X["aria-invalid"]="true");let q=Object.assign({},_);return void 0!==K&&(q=Object.assign({borderWidth:K},_)),h.createElement("div",{className:Z,style:q,onMouseEnter:e=>this.handleMouseOver(e),onMouseLeave:e=>this.handleMouseLeave(e),onClick:e=>this.handleClick(e)},this.renderPrepend(),this.renderPrefix(),h.createElement("input",Object.assign({},X,{ref:U})),this.renderClearBtn(),this.renderSuffix(k),this.renderModeBtn(),this.renderAppend())}}M.propTypes={"aria-label":f.string,"aria-labelledby":f.string,"aria-invalid":f.bool,"aria-errormessage":f.string,"aria-describedby":f.string,"aria-required":f.bool,addonBefore:f.node,addonAfter:f.node,clearIcon:f.node,prefix:f.node,suffix:f.node,mode:f.oneOf(P),value:f.any,defaultValue:f.any,disabled:f.bool,readonly:f.bool,autoFocus:f.bool,type:f.string,showClear:f.bool,hideSuffix:f.bool,placeholder:f.any,size:f.oneOf(S),className:f.string,style:f.object,validateStatus:f.oneOf(L),onClear:f.func,onChange:f.func,onBlur:f.func,onFocus:f.func,onInput:f.func,onKeyDown:f.func,onKeyUp:f.func,onKeyPress:f.func,onEnterPress:f.func,insetLabel:f.node,insetLabelId:f.string,inputStyle:f.object,getValueLength:f.func,preventScroll:f.bool,borderless:f.bool},M.defaultProps={addonBefore:"",addonAfter:"",prefix:"",suffix:"",readonly:!1,type:"text",showClear:!1,hideSuffix:!1,placeholder:"",size:"default",className:"",onClear:i,onChange:i,onBlur:i,onFocus:i,onInput:i,onKeyDown:i,onKeyUp:i,onKeyPress:i,onEnterPress:i,validateStatus:"default",borderless:!1};const $=h.forwardRef(((e,t)=>h.createElement(M,Object.assign({},e,{forwardRef:t}))));export{$ as F,b as I,w as c,v as n,C as s,_ as t};
