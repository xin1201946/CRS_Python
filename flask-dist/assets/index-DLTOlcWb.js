import{x as e,r as t,B as s,e as n,R as o,f as r,c as a,P as i,_ as l,G as c,j as d}from"./index-CUrNDP8Z.js";import{d as p,e as u,f as m,h,g,j as f,k as y,l as b,m as v,n as E,o as w,I,a as T,p as x}from"./index-us_Rri2v.js";const N=e((function(e){return t.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.08 7.6a1.5 1.5 0 0 1 2.12 0l5.66 5.65 5.66-5.65a1.5 1.5 0 1 1 2.12 2.12l-6.72 6.72a1.5 1.5 0 0 1-2.12 0L4.08 9.72a1.5 1.5 0 0 1 0-2.12Z",fill:"currentColor"}))}),"chevron_down");const C=e((function(e){return t.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.44 19.8a1.5 1.5 0 0 1 0-2.13l5.66-5.65-5.66-5.66a1.5 1.5 0 1 1 2.12-2.12l6.72 6.72a1.5 1.5 0 0 1 0 2.12L9.56 19.8a1.5 1.5 0 0 1-2.12 0Z",fill:"currentColor"}))}),"chevron_right"),O={PREFIX:`${s}-dropdown`},k={POSITION_SET:p.POSITION_SET,TRIGGER_SET:["hover","focus","click","custom","contextMenu"],DEFAULT_LEAVE_DELAY:100,ITEM_TYPE:["primary","secondary","tertiary","warning","danger"]},P=4,j=2;class _ extends n{handleVisibleChange(e){this._adapter.setPopVisible(e),this._adapter.notifyVisibleChange(e);const{trigger:t}=this.getProps();if(e&&"click"===t){const e=this._adapter.getPopupId();this.setFocusToFirstMenuItem(e)}}getMenuItemNodes(e){const t=document.getElementById(e);return t?Array.from(t.getElementsByTagName("li")).filter((e=>"false"===e.ariaDisabled)):null}setFocusToFirstMenuItem(e){const t=this.getMenuItemNodes(e);t&&u(t)}setFocusToLastMenuItem(e){const t=this.getMenuItemNodes(e);t&&m(t)}handleKeyDown(e){var t,s;const n=null===(s=null===(t=e.target)||void 0===t?void 0:t.attributes["data-popupid"])||void 0===s?void 0:s.value,{visible:o}=this._adapter.getStates();switch(e.key){case" ":case"Enter":e.target.click();break;case"ArrowDown":this.setFocusToFirstMenuItem(n),o&&h(e);break;case"ArrowUp":this.setFocusToLastMenuItem(n),o&&h(e)}}}class D extends n{constructor(){super(...arguments),this.menuItemNodes=null,this.firstChars=[]}handleEscape(e){if("custom"===this._adapter.getContext("trigger")){(e&&g(document.querySelectorAll("[data-popupid]"),e.id)).focus()}}setFocusByFirstCharacter(e,t){const s=f(this.menuItemNodes,e,this.firstChars,t);s>=0&&y(this.menuItemNodes,this.menuItemNodes[s])}onMenuKeydown(e){const t=b(e.target,"tooltip");this.menuItemNodes||(this.menuItemNodes=[...e.target.parentNode.getElementsByTagName("li")].filter((e=>"true"!==e.ariaDisabled))),0===this.firstChars.length&&this.menuItemNodes.forEach((e=>{var t;this.firstChars.push(null===(t=e.textContent.trim()[0])||void 0===t?void 0:t.toLowerCase())}));const s=this.menuItemNodes.find((e=>0===e.tabIndex));switch(e.key){case" ":case"Enter":e.target.click();break;case"Escape":this.handleEscape(t);break;case"ArrowUp":w(this.menuItemNodes,s),h(e);break;case"ArrowDown":E(this.menuItemNodes,s),h(e);break;default:v(e.key)&&this.setFocusByFirstCharacter(s,e.key)}}}const M=o.createContext({level:0});const F=O.PREFIX;class R extends r{constructor(e){super(e),this.foundation=new D(this.adapter)}get adapter(){return Object.assign({},super.adapter)}render(){const e=this.props,{children:t,className:s,style:n}=e,r=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(s[n[o]]=e[n[o]])}return s}(e,["children","className","style"]);return o.createElement("ul",Object.assign({role:"menu","aria-orientation":"vertical"},r,{className:a(`${F}-menu`,s),style:n,onKeyDown:e=>this.foundation.onMenuKeydown(e)}),t)}}R.propTypes={children:i.node,className:i.string,style:i.object},R.contextType=M;const V=O.PREFIX;class A extends r{render(){const{children:e,disabled:t,className:s,forwardRef:n,style:r,type:i,active:l,icon:c,onKeyDown:d,showTick:p,hover:u}=this.props,{showTick:m}=this.context,h=null!=m?m:p,g=a(s,{[`${V}-item`]:!0,[`${V}-item-disabled`]:t,[`${V}-item-hover`]:u,[`${V}-item-withTick`]:h,[`${V}-item-${i}`]:i,[`${V}-item-active`]:l}),f={};t||["onClick","onMouseEnter","onMouseLeave","onContextMenu"].forEach((e=>{1!==this.context.level&&"onClick"===e?f.onMouseDown=t=>{var s,n;0===t.button&&(null===(n=(s=this.props)[e])||void 0===n||n.call(s,t))}:f[e]=this.props[e]}));let y=null;switch(!0){case h&&l:y=o.createElement(I,null);break;case h&&!l:y=o.createElement(I,{style:{color:"transparent"}});break;default:y=null}let b=null;return c&&(b=o.createElement("div",{className:`${V}-item-icon`},c)),o.createElement("li",Object.assign({role:"menuitem",tabIndex:-1,"aria-disabled":t},f,{onKeyDown:d,ref:e=>n(e),className:g,style:r},this.getDataAttr(this.props)),y,b,e)}}A.propTypes={children:i.oneOfType([i.string,i.node]),name:i.string,disabled:i.bool,selected:i.bool,onClick:i.func,onMouseEnter:i.func,onMouseLeave:i.func,onContextMenu:i.func,className:i.string,style:i.object,forwardRef:i.func,type:i.oneOf(k.ITEM_TYPE),active:i.bool,icon:i.node},A.contextType=M,A.defaultProps={disabled:!1,divided:!1,selected:!1,onMouseEnter:l,onMouseLeave:l,forwardRef:l},A.elementType="Dropdown.Item";const L=O.PREFIX,S=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{style:t,className:s}=e;return o.createElement("div",{className:a(`${L}-divider`,s),style:t})};S.propTypes={style:i.object,className:i.string};const $=O.PREFIX;class K extends t.PureComponent{render(){const{className:e,style:t,children:s}=this.props,{showTick:n}=this.context,r=a({[`${$}-title`]:!0,[`${$}-title-withTick`]:n},e);return o.createElement("div",{className:r,style:t},s)}}K.propTypes={children:i.node,className:i.string,style:i.object},K.contextType=M;var B=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(s[n[o]]=e[n[o]])}return s};const X=k.POSITION_SET,z=k.TRIGGER_SET;class G extends r{constructor(e){super(e),this.handleVisibleChange=e=>this.foundation.handleVisibleChange(e),this.state={popVisible:e.visible},this.foundation=new _(this.adapter),this.tooltipRef=o.createRef()}get adapter(){return Object.assign(Object.assign({},super.adapter),{setPopVisible:e=>this.setState({popVisible:e}),notifyVisibleChange:e=>{var t,s;return null===(s=(t=this.props).onVisibleChange)||void 0===s?void 0:s.call(t,e)},getPopupId:()=>this.tooltipRef.current.getPopupId()})}renderContent(){const{render:e,menu:t,contentClassName:s,style:n,showTick:r,prefixCls:i,trigger:l}=this.props,c=a(i,s),{level:d=0}=this.context,p={showTick:r,level:d+1,trigger:l};let u=null;return o.isValidElement(e)?u=e:Array.isArray(t)&&(u=this.renderMenu()),o.createElement(M.Provider,{value:p},o.createElement("div",{className:c,style:n},o.createElement("div",{className:`${i}-content`,"x-semi-prop":"render"},u)))}renderMenu(){const{menu:e}=this.props,t=e.map(((e,t)=>{switch(e.node){case"title":{const{name:s,node:n}=e,r=B(e,["name","node"]);return o.createElement(G.Title,Object.assign({},r,{key:n+s+t}),s)}case"item":{const{node:s,name:n}=e,r=B(e,["node","name"]);return o.createElement(G.Item,Object.assign({},r,{key:s+n+t}),n)}case"divider":return o.createElement(G.Divider,{key:e.node+t});default:return null}}));return o.createElement(G.Menu,null,t)}renderPopCard(){const{render:e,contentClassName:t,style:s,showTick:n,prefixCls:r}=this.props,i=a(r,t),{level:l=0}=this.context,c={showTick:n,level:l+1};return o.createElement(M.Provider,{value:c},o.createElement("div",{className:i,style:s},o.createElement("div",{className:`${r}-content`},e)))}render(){const e=this.props,{children:t,position:s,trigger:n,onVisibleChange:r,zIndex:i,className:l,motion:d,margin:p,style:u,prefixCls:m}=e,h=B(e,["children","position","trigger","onVisibleChange","zIndex","className","motion","margin","style","prefixCls"]);let{spacing:g}=this.props;const{level:f}=this.context,{popVisible:y}=this.state,b=this.renderContent();return f>0?g="number"==typeof g?g:j:null==g&&(g=P),o.createElement(T,Object.assign({zIndex:i,motion:d,margin:p,content:b,className:l,prefixCls:m,spacing:g,position:s,trigger:n,onVisibleChange:this.handleVisibleChange,showArrow:!1,returnFocusOnClose:!0,ref:this.tooltipRef},h),o.isValidElement(t)?o.cloneElement(t,{className:a(c(t,"props.className"),{[`${m}-showing`]:y}),"aria-haspopup":!0,"aria-expanded":y,onKeyDown:e=>{this.foundation.handleKeyDown(e);const s=c(t,"props.onKeyDown");s&&s(e)}}):t)}}G.Menu=R,G.Item=A,G.Divider=S,G.Title=K,G.contextType=M,G.propTypes={children:i.node,contentClassName:i.oneOfType([i.string,i.array]),className:i.string,getPopupContainer:i.func,margin:i.oneOfType([i.number,i.object]),mouseEnterDelay:i.number,mouseLeaveDelay:i.number,menu:i.array,motion:i.oneOfType([i.bool,i.func,i.object]),onVisibleChange:i.func,prefixCls:i.string,position:i.oneOf(X),rePosKey:i.oneOfType([i.string,i.number]),render:i.node,spacing:i.oneOfType([i.number,i.object]),showTick:i.bool,style:i.object,trigger:i.oneOf(z),visible:i.bool,zIndex:i.number},G.__SemiComponentName__="Dropdown",G.defaultProps=d(G.__SemiComponentName__,{onVisibleChange:l,prefixCls:O.PREFIX,zIndex:x.DEFAULT_Z_INDEX,motion:!0,trigger:"hover",position:"bottom",mouseLeaveDelay:k.DEFAULT_LEAVE_DELAY,showTick:!1,closeOnEsc:!0,onEscKeyDown:l});export{G as D,C as I,N as a};
